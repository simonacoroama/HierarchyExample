{"ast":null,"code":"import { required } from \"./accessors.js\";\nimport { Node, computeHeight } from \"./hierarchy/index.js\";\nvar keyPrefix = \"$\",\n    // Protect against keys like “__proto__”.\npreroot = {\n  depth: -1\n},\n    ambiguous = {};\n\nfunction defaultId(d) {\n  return d.id;\n}\n\nfunction defaultParentId(d) {\n  return d.parentId;\n}\n\nexport default function () {\n  var id = defaultId,\n      parentId = defaultParentId;\n\n  function stratify(data) {\n    var d,\n        i,\n        n = data.length,\n        root,\n        parent,\n        node,\n        nodes = new Array(n),\n        nodeId,\n        nodeKey,\n        nodeByKey = {};\n\n    for (i = 0; i < n; ++i) {\n      d = data[i], node = nodes[i] = new Node(d);\n\n      if ((nodeId = id(d, i, data)) != null && (nodeId += \"\")) {\n        nodeKey = keyPrefix + (node.id = nodeId);\n        nodeByKey[nodeKey] = nodeKey in nodeByKey ? ambiguous : node;\n      }\n    }\n\n    for (i = 0; i < n; ++i) {\n      node = nodes[i], nodeId = parentId(data[i], i, data);\n\n      if (nodeId == null || !(nodeId += \"\")) {\n        if (root) throw new Error(\"multiple roots\");\n        root = node;\n      } else {\n        parent = nodeByKey[keyPrefix + nodeId];\n        if (!parent) throw new Error(\"missing: \" + nodeId);\n        if (parent === ambiguous) throw new Error(\"ambiguous: \" + nodeId);\n        if (parent.children) parent.children.push(node);else parent.children = [node];\n        node.parent = parent;\n      }\n    }\n\n    if (!root) throw new Error(\"no root\");\n    root.parent = preroot;\n    root.eachBefore(function (node) {\n      node.depth = node.parent.depth + 1;\n      --n;\n    }).eachBefore(computeHeight);\n    root.parent = null;\n    if (n > 0) throw new Error(\"cycle\");\n    return root;\n  }\n\n  stratify.id = function (x) {\n    return arguments.length ? (id = required(x), stratify) : id;\n  };\n\n  stratify.parentId = function (x) {\n    return arguments.length ? (parentId = required(x), stratify) : parentId;\n  };\n\n  return stratify;\n}","map":{"version":3,"names":["required","Node","computeHeight","keyPrefix","preroot","depth","ambiguous","defaultId","d","id","defaultParentId","parentId","stratify","data","i","n","length","root","parent","node","nodes","Array","nodeId","nodeKey","nodeByKey","Error","children","push","eachBefore","x","arguments"],"sources":["C:/Hierarchy/HierarchyExample/HirarchyReact/hierarch/node_modules/d3-hierarchy/src/stratify.js"],"sourcesContent":["import {required} from \"./accessors.js\";\nimport {Node, computeHeight} from \"./hierarchy/index.js\";\n\nvar keyPrefix = \"$\", // Protect against keys like “__proto__”.\n    preroot = {depth: -1},\n    ambiguous = {};\n\nfunction defaultId(d) {\n  return d.id;\n}\n\nfunction defaultParentId(d) {\n  return d.parentId;\n}\n\nexport default function() {\n  var id = defaultId,\n      parentId = defaultParentId;\n\n  function stratify(data) {\n    var d,\n        i,\n        n = data.length,\n        root,\n        parent,\n        node,\n        nodes = new Array(n),\n        nodeId,\n        nodeKey,\n        nodeByKey = {};\n\n    for (i = 0; i < n; ++i) {\n      d = data[i], node = nodes[i] = new Node(d);\n      if ((nodeId = id(d, i, data)) != null && (nodeId += \"\")) {\n        nodeKey = keyPrefix + (node.id = nodeId);\n        nodeByKey[nodeKey] = nodeKey in nodeByKey ? ambiguous : node;\n      }\n    }\n\n    for (i = 0; i < n; ++i) {\n      node = nodes[i], nodeId = parentId(data[i], i, data);\n      if (nodeId == null || !(nodeId += \"\")) {\n        if (root) throw new Error(\"multiple roots\");\n        root = node;\n      } else {\n        parent = nodeByKey[keyPrefix + nodeId];\n        if (!parent) throw new Error(\"missing: \" + nodeId);\n        if (parent === ambiguous) throw new Error(\"ambiguous: \" + nodeId);\n        if (parent.children) parent.children.push(node);\n        else parent.children = [node];\n        node.parent = parent;\n      }\n    }\n\n    if (!root) throw new Error(\"no root\");\n    root.parent = preroot;\n    root.eachBefore(function(node) { node.depth = node.parent.depth + 1; --n; }).eachBefore(computeHeight);\n    root.parent = null;\n    if (n > 0) throw new Error(\"cycle\");\n\n    return root;\n  }\n\n  stratify.id = function(x) {\n    return arguments.length ? (id = required(x), stratify) : id;\n  };\n\n  stratify.parentId = function(x) {\n    return arguments.length ? (parentId = required(x), stratify) : parentId;\n  };\n\n  return stratify;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}